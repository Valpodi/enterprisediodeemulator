version: "3"
services:
  tester:
    build:
      context: ./
      dockerfile: ./TesterDockerfile
    volumes:
      - ./emulator_tests.py:/tmp/emulator_tests.py
      - ./import_emulator_tests.py:/tmp/import_emulator_tests.py
      - ./test_helpers.py:/tmp/test_helpers.py
      - ./results/:/tmp/results/
    entrypoint: "python3 -m nose --with-xunit --xunit-file=/tmp/results/${RESULT_FILENAME} ${PYTHON_SCRIPT}"
  diode_emulator:
    build:
      context: ../Emulator
      dockerfile: Dockerfile
    volumes:
      - ../Emulator/config/:/usr/src/app/config/
    entrypoint: "python3 -u /usr/src/app/emulator.py"